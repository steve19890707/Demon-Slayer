(this["webpackJsonpdemon-slayer"]=this["webpackJsonpdemon-slayer"]||[]).push([[0],{77:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n(1),i=n.n(s),c=n(20),o=n.n(c),r=n(2),u=n(5),f=n(22),l=n(25),d=n(16),x=n(3),p=n(14),y=n(17),j={x:0,y:0,checkStatus:!1,boardStatus:!1,debut:!1,roundMove:1},b=Object(y.a)({name:"chess",initialState:[Object(r.a)({name:"Tanjirou",cn:"\u7ac8\u9580 \u70ad\u6cbb\u90ce",id:1,step:3,attack:2,hp:1500,sp:125,dodge:80,fullValue:{hp:1500,sp:125},skill:[{name:"\u65ac\u64ca",atk:200,sp:0,hitfix:0},{name:"\u53c4\u4e4b\u578b\u2015\u6d41\u6d41\u821e",atk:350,sp:15,hitfix:10},{name:"\u634c\u4e4b\u578b\u2015\u6edd\u58fa",atk:500,sp:25,hitfix:5},{name:"\u62fe\u4e4b\u578b\u2015\u751f\u751f\u6d41\u8f49",atk:850,sp:50,hitfix:20}]},j),Object(r.a)({name:"Nezuko",cn:"\u7ac8\u9580 \u79b0\u8c46\u5b50",id:2,step:2,attack:1,hp:2200,sp:200,dodge:80,fullValue:{hp:2200,sp:200},skill:[{name:"\u722a\u64ca",atk:150,sp:0,hitfix:0},{name:"\u8e22\u64ca",atk:250,sp:10,hitfix:15},{name:"\u8840\u9b3c\u8853",atk:1e3,sp:80,hitfix:35}]},j),Object(r.a)({name:"Inosuke",cn:"\u5634\u5e73 \u4f0a\u4e4b\u52a9",id:3,step:4,attack:3,hp:1800,sp:80,dodge:40,fullValue:{hp:1800,sp:80},skill:[{name:"\u65ac\u64ca",atk:50,sp:0,hitfix:0},{name:"\u58f9\u4e4b\u7259\u2015\u7a7f\u900f\u523a\u5c04",atk:120,sp:2,hitfix:0},{name:"\u8cb3\u4e4b\u7259\u2015\u5229\u5203\u5c0d\u5288",atk:200,sp:5,hitfix:0},{name:"\u53c4\u4e4b\u7259\u2015\u7360\u7259\u6495\u626f",atk:400,sp:8,hitfix:0}]},j)],reducers:{stageDebut:function(e,t){var n=t.payload.isDebutChess;e.map((function(t,a){return n.map((function(n){return t.name===n.get("name")?(e[a].debut=!0,e[a].x=n.get("x"),e[a].y=n.get("y")):null}))}))},chessMove:function(e,t){var n=t.payload,a=n.key,s=n.changeX,i=n.changeY;e[a].x=s,e[a].y=i},chessSelected:function(e,t){var n=t.payload.key;e[n].boardStatus=!e[n].boardStatus},chessCheckStatus:function(e,t){var n=t.payload.key;e[n].checkStatus=!e[n].checkStatus},chessDefense:function(e,t){var n=t.payload,a=n.key,s=n.damage;e[a].hp-=s},chessAttackResult:function(e,t){var n=t.payload,a=n.key,s=n.lessSp;e[a].sp-=s},chessDead:function(e,t){var n=t.payload.key;e[n].debut=!1,e[n].hp=e[n].fullValue.hp,e[n].sp=e[n].fullValue.sp},chessMoved:function(e,t){e[t.payload.key].roundMove-=0},chessRoundRest:function(e){for(var t=0;t<e.length;t++)e[t].roundMove=1}}}),h=b.reducer,S=b.actions,m=S.stageDebut,O=S.chessMove,k=S.chessSelected,g=S.chessCheckStatus,v=S.chessAttackResult,T=S.chessDead,w=S.chessMoved,C=S.chessDefense,z=S.chessRoundRest,I={x:0,y:0,checkStatus:!1,boardStatus:!1,debut:!1,roundAttack:!1},E=Object(y.a)({name:"enemyChess",initialState:[Object(r.a)({name:"Teoni",cn:"\u624b\u9b3c",id:1,hp:2e3,sp:100,dodge:25,fullValue:{hp:2e3,sp:100},skill:[{name:"\u80e1\u4e82\u6bc6\u6253",atk:150,sp:0,hitfix:10},{name:"\u4f60\u662f\u7b2c\u5341\u56db\u500b",atk:500,sp:25,hitfix:20}]},I),Object(r.a)({name:"Nomanooni",cn:"\u6cbc\u9b3c",id:2,hp:1500,sp:200,dodge:30,fullValue:{hp:1500,sp:200},skill:[{name:"\u722a\u64ca",atk:70,sp:0,hitfix:15},{name:"\u5206\u8eab\u653b\u64ca",atk:600,sp:15,hitfix:30}]},I)],reducers:{enemyStageDebut:function(e,t){var n=t.payload.isDebutChess;e.map((function(t,a){return n.map((function(n){return t.name===n.get("name")?(e[a].debut=!0,e[a].x=n.get("x"),e[a].y=n.get("y")):null}))}))},enemyChessSelected:function(e,t){var n=t.payload.key;e[n].boardStatus=!e[n].boardStatus},enemyChessCheckStatus:function(e,t){var n=t.payload.key;e[n].checkStatus=!e[n].checkStatus},enemyChessDefense:function(e,t){var n=t.payload,a=n.key,s=n.damage;e[a].hp-=s},enemyChessAttackResult:function(e,t){var n=t.payload,a=n.key,s=n.lessSp;e[a].sp-=s},enemyChessDead:function(e,t){var n=t.payload.key;e[n].debut=!1,e[n].hp=e[n].fullValue.hp,e[n].sp=e[n].fullValue.sp}}}),F=E.reducer,R=E.actions,H=R.enemyStageDebut,N=R.enemyChessSelected,M=R.enemyChessCheckStatus,P=R.enemyChessDefense,G=R.enemyChessAttackResult,B=R.enemyChessDead,L=n(4),A="localhost"===window.location.hostname?"./Demon-Slayer/":"./",D=new L.h,U={open:new p.Howl({src:["".concat(A,"audio/bgm-open.mp3")],preload:"metadata",loop:!0}),round:new p.Howl({src:["".concat(A,"audio/bgm-round.mp3")],preload:"metadata",loop:!0}),KimetsuNoYaiba:new p.Howl({src:["".concat(A,"audio/bgm-KimetsuNoYaiba.mp3")],preload:"metadata",loop:!0}),KimetsuNoYaibaEnemy:new p.Howl({src:["".concat(A,"audio/bgm-KimetsuNoYaibaEnemy.mp3")],preload:"metadata",loop:!0})};D.add("Tanjirou-head-default","".concat(A,"imgs/Tanjirou/head-default.png")).add("Tanjirou-talk-default","".concat(A,"imgs/Tanjirou/talk-default.jpg")).add("Tanjirou-talk-attack","".concat(A,"imgs/Tanjirou/talk-attack.jpg")).add("Tanjirou-talk-def","".concat(A,"imgs/Tanjirou/talk-def.jpg")).add("Tanjirou-talk-dodge","".concat(A,"imgs/Tanjirou/talk-dodge.jpg")).add("Tanjirou-talk-dead","".concat(A,"imgs/Tanjirou/talk-dead.jpg")).add("Tanjirou-fight-typeA","".concat(A,"imgs/Tanjirou/fight-typeA.png")).add("Tanjirou-fight-typeB","".concat(A,"imgs/Tanjirou/fight-typeB.png")).add("Tanjirou-skill3-show","".concat(A,"imgs/Tanjirou/skill/skill3.mp4")).add("Nezuko-head-default","".concat(A,"imgs/Nezuko/head-default.jpg")).add("Nezuko-talk-default","".concat(A,"imgs/Nezuko/talk-default.jpg")).add("Nezuko-talk-attack","".concat(A,"imgs/Nezuko/talk-attack.jpg")).add("Nezuko-talk-def","".concat(A,"imgs/Nezuko/talk-def.jpg")).add("Nezuko-talk-dodge","".concat(A,"imgs/Nezuko/talk-dodge.jpg")).add("Nezuko-talk-dead","".concat(A,"imgs/Nezuko/talk-dead.jpg")).add("Nezuko-fight","".concat(A,"imgs/Nezuko/fight.png")).add("Inosuke-head-default","".concat(A,"imgs/Inosuke/head-default.jpg")).add("Inosuke-fight","".concat(A,"imgs/Inosuke/fight.png")).add("Teoni-head-default","".concat(A,"imgs/Teoni/head-default.png")).add("Teoni-talk-default","".concat(A,"imgs/Teoni/talk-default.jpg")).add("Teoni-talk-attack","".concat(A,"imgs/Teoni/talk-attack.jpg")).add("Teoni-talk-def","".concat(A,"imgs/Teoni/talk-def.jpg")).add("Teoni-talk-dodge","".concat(A,"imgs/Teoni/talk-dodge.jpg")).add("Teoni-talk-dead","".concat(A,"imgs/Teoni/talk-dead.jpg")).add("Teoni-fight","".concat(A,"imgs/Teoni/fight.png")).add("Nomanooni-head-default","".concat(A,"imgs/Nomanooni/head-default.jpg")).add("Nomanooni-fight","".concat(A,"imgs/Nomanooni/fight.png")).add("stageOne-BG","".concat(A,"imgs/background/stage1-background.png")).add("stageOne-main-BG","".concat(A,"imgs/background/stage1-main-background.jpg")).add("logo","".concat(A,"imgs/common/logo.png")).add("atkIcon","".concat(A,"imgs/common/atk.png")).add("defIcon","".concat(A,"imgs/common/def.png")).add("otherIcon","".concat(A,"imgs/common/other.png")).add("closeIcon","".concat(A,"imgs/common/close.png")).add("startBtn","".concat(A,"imgs/common/startBtn.png")).add("endBtn","".concat(A,"imgs/common/end.png")).add("fightOff","".concat(A,"imgs/common/fightOff.png")).add("fightDef","".concat(A,"imgs/common/fightDef.png")).load();var Y=function(e){var t=e.props.setRoundStart,n=Object(s.useState)(200),i=Object(u.a)(n,2),c=i[0],o=i[1],r=Object(s.useState)(!1),f=Object(u.a)(r,2),l=f[0],d=f[1],p=Object(s.useState)(!1),y=Object(u.a)(p,2),j=y[0],b=y[1],h=0;return Object(x.useTick)((function(e){var t=h+=.25*e;c<350&&o((function(e){return e+Math.floor(t)}))})),Object(s.useEffect)((function(){c>=350&&b(!0)}),[c]),Object(a.jsx)(x.Container,{sortableChildren:!0,children:l?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(x.Sprite,{anchor:.5,x:400,y:250,width:c,height:c,image:D.resources.logo.data}),j&&Object(a.jsx)(x.Sprite,{interactive:!0,buttonMode:!0,anchor:.5,x:400,y:450,width:120,height:56,image:D.resources.startBtn.data,pointertap:function(){U.open.fade(1,0,1e3),t(!0)}})]}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(x.Graphics,{interactive:!0,buttonMode:!0,x:0,y:0,zIndex:1,draw:function(e){e.beginFill("0x0000"),e.drawRoundedRect(0,0,800,600,0),e.endFill()},pointertap:function(){U.open.play(),d(!0)}}),Object(a.jsx)(x.Text,{text:"\u4efb\u610f\u9ede\u64ca",zIndex:2,anchor:.5,x:400,y:300,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:24,fill:"#ffffff"})})]})})},q=20,K=15,V=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=[],n=0;n<K;n++)t.push(e(n,"0x383838"));return t}((function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=[],a=0;a<q;a++)n.push({x:a,y:e,color:t,alpha:0,zIndex:1,isInteractive:!1});return n})),X=Object(y.a)({name:"chessMap",initialState:V,reducers:{MoveSelect:function(e,t){for(var n=t.payload,a=n.position,s=n.step,i=n.changeColor,c=n.alphaVal,o=void 0===c?1:c,r=0;r<s+1;r++)a.x+r<=q-1&&(e[a.y][a.x+r].color=i,e[a.y][a.x+r].isInteractive=!1,e[a.y][a.x+r].alpha=o,e[a.y][a.x+r].zIndex=1),a.y+r<=K-1&&(e[a.y+r][a.x].color=i,e[a.y+r][a.x].isInteractive=!1,e[a.y+r][a.x].alpha=o,e[a.y+r][a.x].zIndex=1),a.x-r>=0&&(e[a.y][a.x-r].color=i,e[a.y][a.x-r].isInteractive=!1,e[a.y][a.x-r].alpha=o,e[a.y][a.x-r].zIndex=1),a.y-r>=0&&(e[a.y-r][a.x].color=i,e[a.y-r][a.x].isInteractive=!1,e[a.y-r][a.x].alpha=o,e[a.y-r][a.x].zIndex=1)},GetMove:function(e,t){for(var n=t.payload,a=n.position,s=n.step,i=n.changeColor,c=n.currentChessPositions,o=0;o<s+1;o++)a.x+o<=q-1&&(e[a.y][a.x+o].color=i,e[a.y][a.x+o].isInteractive=!0,e[a.y][a.x+o].alpha=.5,e[a.y][a.x+o].zIndex=1),a.y+o<=K-1&&(e[a.y+o][a.x].color=i,e[a.y+o][a.x].isInteractive=!0,e[a.y+o][a.x].alpha=.5,e[a.y+o][a.x].zIndex=1),a.x-o>=0&&(e[a.y][a.x-o].color=i,e[a.y][a.x-o].isInteractive=!0,e[a.y][a.x-o].alpha=.5,e[a.y][a.x-o].zIndex=1),a.y-o>=0&&(e[a.y-o][a.x].color=i,e[a.y-o][a.x].isInteractive=!0,e[a.y-o][a.x].alpha=.5,e[a.y-o][a.x].zIndex=1);c.map((function(t){return e[t.y][t.x].isInteractive=!1}))},GetAttack:function(e,t){for(var n=t.payload,a=n.position,s=n.step,i=n.changeColor,c=n.currentChessPositions,o=0;o<s+1;o++)a.x+o<=q-1&&(e[a.y][a.x+o].color=i,e[a.y][a.x+o].isInteractive=!0,e[a.y][a.x+o].alpha=.5,e[a.y][a.x+o].zIndex=3),a.y+o<=K-1&&(e[a.y+o][a.x].color=i,e[a.y+o][a.x].isInteractive=!0,e[a.y+o][a.x].alpha=.5,e[a.y+o][a.x].zIndex=3),a.x-o>=0&&(e[a.y][a.x-o].color=i,e[a.y][a.x-o].isInteractive=!0,e[a.y][a.x-o].alpha=.5,e[a.y][a.x-o].zIndex=3),a.y-o>=0&&(e[a.y-o][a.x].color=i,e[a.y-o][a.x].isInteractive=!0,e[a.y-o][a.x].alpha=.5,e[a.y-o][a.x].zIndex=3);c.map((function(t){return e[t.y][t.x].isInteractive=!1,e[t.y][t.x].zIndex=1}))}}}),W=X.reducer,J=X.actions,Q=J.MoveSelect,Z=J.GetMove,$=J.GetAttack,_=L.r.WHITE,ee=function(e){var t=e.reduxProps,n=t.chess,s=t.enemyChess,c=t.chessMap,o=t.currentChess,u=t.dispatch,f=t.setTipStatus,l=t.setMoveStep,d=t.setBattleInfo;return Object(a.jsx)(i.a.Fragment,{children:c.map((function(e){return e.map((function(e,t){return Object(a.jsx)(x.Sprite,{interactive:e.isInteractive,buttonMode:e.isInteractive,zIndex:e.zIndex,width:40,height:40,x:40*e.x,y:40*e.y,tint:e.color,alpha:e.alpha,texture:_,pointertap:function(){switch(o.type){case"MOVE":f({title:"\u78ba\u5b9a\u79fb\u52d5?",status:!0,position:{x:e.x,y:e.y}}),u(Q({position:{x:n[o.key].x,y:n[o.key].y},step:n[o.key].step,changeColor:"0x06d6a0",alphaVal:.5}));break;case"ATTACK":if(function(e,t){var n=!1;return s.map((function(a){return a.debut&&e===a.x&&t===a.y?n=!0:null})),n}(e.x,e.y)){var t=function(e,t){var n={};return s.map((function(a,s){return a.debut&&e===a.x&&t===a.y?n=Object(r.a)(Object(r.a)({},a),{},{key:s}):null})),n}(e.x,e.y);d({status:!0,attacker:Object(r.a)({key:o.key},n[o.key]),target:Object(r.a)({key:t.key},t)}),u(Q({position:{x:n[o.key].x,y:n[o.key].y},step:n[o.key].attack,changeColor:"0x383838",alphaVal:0}))}else l(!0),u(Q({position:{x:n[o.key].x,y:n[o.key].y},step:n[o.key].acttack,changeColor:"0x383838",alphaVal:0}));break;default:return}}},t)}))}))})},te=function(e){var t=e.props,n=t.chess,s=t.currentChess,i=t.tipStatus,c=t.currentBGM,o=t.dispatch,u=t.setMoveStep,f=t.setTipStatus,l=t.setOtherTab,d=t.setRoundNum,p=t.setUsualTip,y=t.setFadeBGM;return Object(a.jsxs)(x.Graphics,{x:400,y:300,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x22223b"),e.drawRoundedRect(-90,-50,180,100,8),e.endFill()},children:[Object(a.jsx)(x.Text,{text:i.title,anchor:.5,x:0,y:-20,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:["#ffffff","#ffffff"]})}),Object(a.jsx)(x.Text,{interactive:!0,buttonMode:!0,anchor:.5,text:"\u78ba\u5b9a",x:-30,y:20,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:["#ffffff","#ffffff"]}),pointertap:function(){switch(s.type){case"MOVE":o(O({key:s.key,changeX:i.position.x,changeY:i.position.y})),o(w({key:s.key})),o(Q({position:{x:n[s.key].x,y:n[s.key].y},step:n[s.key].step,changeColor:"0x383838",alphaVal:0})),u(!0),f((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:!1})}));break;case"ENDROUND":l(!1),d((function(e){return e+1})),f((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:!1})})),p({title:"\u6575\u65b9\u56de\u5408",status:!0}),y(c);break;default:return}}}),Object(a.jsx)(x.Text,{interactive:!0,buttonMode:!0,anchor:.5,text:"\u53d6\u6d88",x:30,y:20,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:["#ffffff","#ffffff"]}),pointertap:function(){switch(s.type){case"MOVE":o(Q({position:{x:n[s.key].x,y:n[s.key].y},step:n[s.key].step,changeColor:"0x383838",alphaVal:0})),u(!0),f((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:!1})}));break;case"ENDROUND":f((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:!1})}));break;default:return}}})]})},ne=n(13),ae=Object(ne.a)({stageOne:{debutChess:[{name:"Tanjirou",x:6,y:7}],debutEnemyChess:[{name:"Teoni",x:14,y:7}],ruleText:{win:"\u64ca\u6557\u624b\u9b3c\u3002",lose:"\u7ac3\u9580 \u78b3\u6cbb\u90ce \u6230\u6557\u3002"},isWin:function(e){var t=0;return e.map((function(e){return e.debut?t+=e.hp:null})),!(t>0)},isLose:function(e){var t=0;return e.map((function(e){return e.debut?t+=e.hp:null})),!(t>0)}},stageTwo:{debutChess:[{name:"Tanjirou",x:3,y:9},{name:"Nezuko",x:3,y:11}],debutEnemyChess:[{name:"Nomanooni",x:16,y:7}]}}),se=function(e){var t=e.props,n=t.stageStatus,i=t.chess,c=t.currentChess,o=t.enemyChess,r=t.currentBGM,f=t.usualTip,l=t.setMoveStep,d=t.setUsualTip,p=t.setCurrentChess,y=t.setFadeBGM,j=t.setEnemyRoundTab,b=Object(s.useState)(["#ffffff","#ffffff"]),h=Object(u.a)(b,2),S=h[0],m=h[1];return Object(a.jsxs)(x.Graphics,{x:400,y:300,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x22223b"),e.drawRoundedRect(-90,-50,180,100,8),e.endFill()},children:[Object(a.jsx)(x.Text,{text:f.title,anchor:.5,x:0,y:-20,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:S})}),Object(a.jsx)(x.Text,{interactive:!0,buttonMode:!0,anchor:.5,text:"\u78ba\u5b9a",x:0,y:20,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:["#ffffff","#ffffff"]}),pointertap:function(){switch(c.type){case"ATTACK":var e=ae.getIn([n,"isWin"]),t=ae.getIn([n,"isLose"]);e(o)?(m(["#ffffff","#06d6a0"]),p({key:0,type:"CHECKWIN"}),d({title:"\u4f5c\u6230\u7372\u52dd!",status:!0})):t(i)?(m(["#dc2f02","#d00000"]),p({key:0,type:"CHECKLOSE"}),d({title:"\u4f5c\u6230\u5931\u6557!",status:!0})):(l(!0),d({title:"",status:!1}));break;case"CHECKWIN":case"CHECKLOSE":l(!0),m(["#ffffff","#ffffff"]),d({title:"",status:!1});break;case"ENDROUND":j({oder:0,status:!0}),d({title:"",status:!1});break;case"USERROUND":y(r),d({title:"",status:!1});break;default:return}}})]})},ie=function(e,t){return!(100+e-t<Math.round(100*Math.random()+1))},ce=function(e){var t=e.props,n=t.battleInfo,c=t.setMoveStep,o=t.setBattleInfo,r=t.setAnimeShow,f=t.setCurrentBGM,l=t.dispatch,d=Object(s.useState)({key:0}),p=Object(u.a)(d,2),y=p[0],j=p[1],b=function(e){var t=e.pX,n=void 0===t?0:t,s=e.pY,c=void 0===s?0:s,o=e.data;return Object(a.jsxs)(x.Container,{x:n,y:c,sortableChildren:!0,children:[Object(a.jsx)(x.Text,{text:"\u653b",x:220,y:0,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:30,fill:["#ffffff","#00ff99"]})}),Object(a.jsx)(x.Text,{text:o.cn,x:60,y:-3,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{text:"".concat(o.hp," / ").concat(o.fullValue.hp),x:60,y:17,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ff6b6b"})}),Object(a.jsx)(x.Text,{text:"".concat(o.sp," / ").concat(o.fullValue.sp),x:60,y:34,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#0466c8"})}),Object(a.jsx)(x.Sprite,{width:50,height:50,x:0,y:0,image:D.resources["".concat(o.name,"-head-default")].data}),Object(a.jsx)(x.Text,{text:"\u62db\u5f0f\u9078\u64c7\uff1a",x:0,y:80,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ffffff"})}),Object(a.jsx)(x.Graphics,{x:0,y:115,zIndex:1,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x0f0f1b"),e.drawRoundedRect(0,0,240,180,8),e.endFill()}}),o.skill.map((function(e,t){var n=o.sp-e.sp>=0;return Object(a.jsx)(i.a.Fragment,{children:Object(a.jsx)(x.Text,{zIndex:2,interactive:n,buttonMode:!0,text:e.name,x:20,y:130+24*t,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:y.key===t&&n?["#ffffff","#00ff99"]:n?"#ffffff":"#8d99ae",fontWeight:y.key===t?600:300}),pointertap:function(){return j({key:t})}})},t)}))]})},h=function(e){var t=e.pX,n=void 0===t?0:t,s=e.pY,i=void 0===s?0:s,c=e.data;return Object(a.jsxs)(x.Container,{x:n,y:i,sortableChildren:!0,children:[Object(a.jsx)(x.Text,{text:"\u9632",x:0,y:0,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:30,fill:["#ffffff","#ee6c4d"]})}),Object(a.jsx)(x.Text,{text:c.cn,anchor:{x:1,y:0},x:190,y:-3,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{text:"".concat(c.hp," / ").concat(c.fullValue.hp),anchor:{x:1,y:0},x:190,y:17,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ff6b6b"})}),Object(a.jsx)(x.Text,{text:"".concat(c.sp," / ").concat(c.fullValue.sp),anchor:{x:1,y:0},x:190,y:34,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#0466c8"})}),Object(a.jsx)(x.Sprite,{width:50,height:50,x:200,y:0,image:D.resources["".concat(c.name,"-head-default")].data})]})},S=function(e){var t=e.pX,n=e.pY,s=e.data;return Object(a.jsxs)(x.Container,{x:t,y:n,sortableChildren:!0,children:[Object(a.jsx)(x.Graphics,{x:0,y:0,zIndex:1,draw:function(e){e.lineStyle(1,"0x00ff99",1),e.beginFill("0x0f0f1b"),e.drawRoundedRect(0,0,265,215,8),e.endFill()}}),Object(a.jsx)(x.Text,{text:"\u62db\u5f0f\uff1a",zIndex:2,x:20,y:20,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{text:"".concat(s.attacker.skill[y.key].name),zIndex:2,x:80,y:22,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#00ff99"})}),Object(a.jsx)(x.Text,{text:"\u653b\u64ca\u529b\uff1a",zIndex:2,x:20,y:50,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{text:"".concat(s.attacker.skill[y.key].atk),zIndex:2,x:100,y:52,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#fdc500"})}),Object(a.jsx)(x.Text,{text:"\u547d\u4e2d\u7387\uff1a",zIndex:2,x:20,y:80,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{text:"".concat(100+(s.attacker.skill[y.key].hitfix-s.target.dodge>=0?0:s.attacker.skill[y.key].hitfix-s.target.dodge),"%"),zIndex:2,x:100,y:82,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{text:"\u6d88\u8017\uff1a",zIndex:2,x:20,y:110,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{text:"".concat(s.attacker.skill[y.key].sp),zIndex:2,x:80,y:110,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#0466c8"})})]})};return Object(a.jsxs)(x.Graphics,{x:400,y:300,zIndex:99,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x22223b"),e.drawRoundedRect(-300,-200,600,400,8),e.endFill()},children:[Object(a.jsx)(b,{pX:-270,pY:-180,data:n.attacker}),Object(a.jsx)(h,{pX:20,pY:-180,data:n.target}),Object(a.jsx)(S,{pX:0,pY:-100,data:n}),Object(a.jsx)(x.Text,{interactive:!0,buttonMode:!0,text:"\u653b\u64ca",anchor:.5,x:180,y:160,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:"#ffffff"}),pointertap:function(){f(n.attacker.name);var e=ie(n.attacker.skill[y.key].hitfix,n.target.dodge);l(v({key:n.attacker.key,lessSp:n.attacker.skill[y.key].sp})),l(w({key:n.attacker.key})),e&&l(P({key:n.target.key,damage:n.attacker.skill[y.key].atk})),r({status:!0,type:"USER",isHit:e,attacker:{key:n.attacker.key,skill:n.attacker.skill[y.key],prevSP:n.attacker.sp},target:{key:n.target.key,isHit:e,prevLife:n.target.hp}}),o({status:!1,attacker:{key:""},target:{key:""}})}}),Object(a.jsx)(x.Text,{interactive:!0,buttonMode:!0,text:"\u53d6\u6d88",anchor:.5,x:240,y:160,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:"#ffffff"}),pointertap:function(){c(!0),o({status:!1,attacker:{key:""},target:{key:""}})}})]})},oe=n(6),re=function(e){var t=e.props,n=t.stageStatus,s=t.BGstatus,i=t.BGprop,c=t.SkBGprop,o=t.setSkBGpops,u=t.setBGpops;return Object(a.jsxs)(a.Fragment,{children:["STOP"===s.type&&Object(a.jsx)(x.Sprite,{x:-400,y:-100,zIndex:1,width:1600,height:500,anchor:.5,image:D.resources["".concat(n,"-BG")].data}),"STANDBY"===s.type&&Object(a.jsx)(oe.Spring,{from:{x:-400,y:-100},to:{x:i.toX,y:-100},config:{duration:i.duration},onRest:function(){-400===i.toX?u({toX:400,duration:2e4}):u({toX:-400,duration:-1e3})},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:1,width:1600,height:500,anchor:.5,image:D.resources["".concat(n,"-BG")].data},e))}}),"ENEMYSTANDBY"===s.type&&Object(a.jsx)(oe.Spring,{from:{x:400,y:-100},to:{x:-i.toX,y:-100},config:{duration:i.duration},onRest:function(){400===-i.toX?u({toX:400,duration:2e4}):u({toX:-400,duration:-1e3})},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:1,width:1600,height:500,anchor:.5,image:D.resources["".concat(n,"-BG")].data},e))}}),"SKILL"===s.type&&Object(a.jsx)(oe.Spring,{from:{x:-400,y:-100},to:{x:c.toX,y:-100},config:{duration:c.duration},onRest:function(){-400===c.toX?o({toX:400,duration:500}):o({toX:-400,duration:-1e3})},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:1,width:1600,height:500,anchor:.5,image:D.resources["".concat(n,"-BG")].data},e))}}),"ENEMYSKILL"===s.type&&Object(a.jsx)(oe.Spring,{from:{x:400,y:-100},to:{x:-c.toX,y:-100},config:{duration:c.duration},onRest:function(){400===-c.toX?o({toX:400,duration:500}):o({toX:-400,duration:-1e3})},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:1,width:1600,height:500,anchor:.5,image:D.resources["".concat(n,"-BG")].data},e))}})]})},ue=function(e){var t=e.right,n=void 0===t?{}:t,s=e.left,i=void 0===s?{}:s,c=e.showType,o=void 0===c?"":c,r=e.targetHp,u=void 0===r?0:r,f=e.attackerSp,l=void 0===f?0:f,d=function(e,t){return(Number(t)-Number(e))/(Number(t)/200)},p=function(e,t){return(Number(t)-Number(e))/(Number(t)/100)};return Object(a.jsx)(x.Graphics,{x:-400,y:-300,zIndex:98,draw:function(e){e.beginFill("0x000f23"),e.drawRoundedRect(0,0,800,80,0),e.endFill()},children:Object(a.jsxs)(x.Container,{sortableChildren:!0,children:[Object(a.jsx)(x.Sprite,{width:42,height:42,x:370,y:40,anchor:.5,image:D.resources["".concat("USER"===o?"defIcon":"atkIcon")].data}),Object(a.jsx)(x.Sprite,{width:42,height:42,x:420,y:40,anchor:.5,image:D.resources["".concat("USER"===o?"atkIcon":"defIcon")].data}),Object(a.jsx)(x.Sprite,{width:50,height:50,x:50,y:15,image:D.resources["".concat(i.name,"-head-default")].data}),Object(a.jsx)(x.Text,{text:"".concat("USER"===o?u:i.hp," / ").concat(i.fullValue.hp),anchor:{x:1,y:0},x:320,y:10,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#e71d36"})}),Object(a.jsx)(x.Graphics,{x:320,y:35,zIndex:1,draw:function(e){e.beginFill("0xe71d36"),e.drawRoundedRect(0,0,-200,10,0),e.endFill()}}),Object(a.jsx)(x.Graphics,{x:320,y:35,zIndex:2,draw:function(e){e.beginFill("0x333533"),e.drawRoundedRect(-200,0,d("USER"===o?u:i.hp,i.fullValue.hp),10,0),e.endFill()}}),Object(a.jsx)(x.Text,{text:"".concat("USER"===o?i.sp:l," / ").concat(i.fullValue.sp),anchor:{x:1,y:.3},x:210,y:55,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#4A86E8"})}),Object(a.jsx)(x.Graphics,{x:320,y:55,zIndex:1,draw:function(e){e.beginFill("0x4A86E8"),e.drawRoundedRect(0,0,-100,10,0),e.endFill()}}),Object(a.jsx)(x.Graphics,{x:220,y:55,zIndex:2,draw:function(e){e.beginFill("0x333533"),e.drawRoundedRect(0,0,p("USER"===o?i.sp:l,i.fullValue.sp),10,0),e.endFill()}}),Object(a.jsx)(x.Sprite,{width:50,height:50,x:690,y:15,image:D.resources["".concat(n.name,"-head-default")].data}),Object(a.jsx)(x.Text,{text:"".concat("USER"===o?n.hp:u," / ").concat(n.fullValue.hp),anchor:{x:1,y:0},x:670,y:10,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#e71d36"})}),Object(a.jsx)(x.Graphics,{x:670,y:35,zIndex:1,draw:function(e){e.beginFill("0xe71d36"),e.drawRoundedRect(0,0,-200,10,0),e.endFill()}}),Object(a.jsx)(x.Graphics,{x:670,y:35,zIndex:2,draw:function(e){e.beginFill("0x333533"),e.drawRoundedRect(-200,0,d("USER"===o?n.hp:u,n.fullValue.hp),10,0),e.endFill()}}),Object(a.jsx)(x.Text,{text:"".concat("USER"===o?l:n.sp," / ").concat(n.fullValue.sp),anchor:{x:1,y:.3},x:560,y:55,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#4A86E8"})}),Object(a.jsx)(x.Graphics,{x:670,y:55,zIndex:1,draw:function(e){e.beginFill("0x4A86E8"),e.drawRoundedRect(0,0,-100,10,0),e.endFill()}}),Object(a.jsx)(x.Graphics,{x:570,y:55,zIndex:2,draw:function(e){e.beginFill("0x333533"),e.drawRoundedRect(0,0,p("USER"===o?l:n.sp,n.fullValue.sp),10,0),e.endFill()}})]})})},fe=Object(ne.a)({Tanjirou:{default:["(\u5099\u6230\u4e2d)","(\u5099\u6230\u4e2d)"],attack:["\u6211\u8981\u6210\u70ba\u5f37\u8005\uff0c\u7528\u5f37\u8005\u7684\u529b\u91cf\u53bb\u4fdd\u8b77\u5f31\u8005\u3002","\u7121\u8ad6\u9b3c\u596a\u8d70\u591a\u5c11\u751f\u547d\uff0c\u4eba\u985e\u7684\u610f\u5fd7\u662f\u600e\u6a23\u90fd\u4e0d\u6703\u88ab\u6253\u6557\uff01"],dodge:["\u5371\u96aa!!","\u51b7\u975c\u4e0b\u4f86! \u53ef\u4ee5\u6230\u52dd\u7684\u3002"],def:["\u9b3c\u6bba\u968a\u4e0d\u6703\u88ab\u4e00\u9ede\u5c0f\u50b7\u7d66\u6253\u5012!","\u4e0d\u597d\u4e86! \u8abf\u6574\u547c\u5438\u3002"],dead:["\u5c0d\u4e0d\u8d77....\u9c57\u7027\u5e2b\u5085..","\u79b0\u8c46\u5b50..."]},Nezuko:{default:["(\u5099\u6230\u4e2d)","(\u5099\u6230\u4e2d)"],attack:["......!!(\u4eba\u985e\u662f\u5bb6\u4eba)","......!!(\u6253\u5012\u60e1\u9b3c)"],dodge:["......!!(\u5371\u96aa)","......!!(\u6c92\u4e8b\u7684)"],def:["......!!(\u5371\u96aa)","......!!(\u6c92\u4e8b\u7684)"],dead:["......!?",".....(\u54e5\u54e5)"]},Teoni:{default:["(\u5099\u6230\u4e2d)","(\u5099\u6230\u4e2d)"],attack:["\u7375\u9b3c\u4eba\u662f\u6700\u4e0a\u7b49\u7684\u98df\u7269!!","\u770b\u6211\u5403\u4e86\u4f60!!"],dodge:["\u6c92\u7528\u6c92\u7528 \u54c8\u54c8\u54c8\u54c8!","\u5c31\u9019\u9ede\u7a0b\u5ea6\u55ce? \u53ef\u60b2\u7684\u528d\u58eb\u3002"],def:["\u4e0d\u4e45\u5c31\u8f2a\u5230\u4f60\u7684\u6b7b\u671f\u4e86!","\u6211\u6703\u5403\u4e86\u4f60!!"],dead:["\u751a\u9ebc!?.....\u6211\u7adf\u7136\u6703\u6b7b\u5728\u7375\u9b3c\u4eba\u624b\u4e0a.....","\u751a\u9ebc!?.....\u6211\u7adf\u7136\u6703\u6b7b\u5728\u7375\u9b3c\u4eba\u624b\u4e0a....."]}}),le=function(e){var t=e.right,n=void 0===t?{}:t,i=e.left,c=void 0===i?{}:i,o=e.linesStatus,r=void 0===o?{}:o,f="USER"===r.character?n.name:c.name,l=fe.getIn([f,r.status]).size-1,d=Object(s.useState)(Math.round(Math.random()*l)),p=Object(u.a)(d,1)[0];return Object(a.jsx)(x.Graphics,{x:-400,y:150,zIndex:98,draw:function(e){e.beginFill("0x000f23"),e.drawRoundedRect(0,0,800,150,0),e.endFill()},children:Object(a.jsxs)(x.Container,{sortableChildren:!0,children:[Object(a.jsx)(x.Sprite,{width:100,height:100,x:50,y:25,image:D.resources["".concat(f,"-talk-").concat(r.status)].data}),Object(a.jsx)(x.Text,{text:fe.getIn([f,r.status,p]),anchor:{x:0,y:0},x:170,y:60,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#ffff"})})]})})},de=function(e){var t=e.skillName,n=e.attackerName,i=e.isHit,c=e.targetLife,o=e.attackerSp,f=e.resultLife,l=e.resultSp,d=e.BGstatus,x=e.setBGstatus,p=e.setAnimeIsDone,y=e.setTargetHp,j=e.setAttackerSp,b=e.setLinesStatus,h=e.setShowSkill,S=e.defXPostion,m=e.steps,O=e.ShowType,k=Object(s.useState)({x:0,y:0,tint:16777215,alpha:1,mass:1,friction:20,tension:170}),g=Object(u.a)(k,2),v=g[0],T=g[1];return Object(s.useEffect)((function(){if(d.defence&&"\u9632\u79a6"===t){var e=m({skillName:t,isHit:i,BGstatus:d,resultLife:f,setAnimeIsDone:p,setLinesStatus:b,setPosition:T});return function(){return clearTimeout(e)}}}),[d,t,i,f,p,m,b]),Object(s.useEffect)((function(){if("\u9632\u79a6"!==t){var e=m({skillName:t,isHit:i,targetLife:c,attackerSp:o,resultLife:f,resultSp:l,setBGstatus:x,setTargetHp:y,setAttackerSp:j,setLinesStatus:b,setShowSkill:h,setPosition:T});return function(){return clearTimeout(e)}}T((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:S,y:10})}))}),[t,i,c,o,f,l,x,y,j,S,m,b,h]),Object(a.jsx)(O,{skillName:t,attackerName:n,position:v})},xe=n(9),pe=n(8),ye=n.n(pe),je=function(e){var t=e.skillName,n=void 0===t?"":t,a=e.isHit,s=void 0!==a&&a,i=e.targetLife,c=void 0===i?0:i,o=e.attackerSp,u=void 0===o?0:o,f=e.resultLife,l=void 0===f?0:f,d=e.resultSp,x=void 0===d?0:d,p=e.BGstatus,y=void 0===p?{}:p,j=e.setBGstatus,b=void 0===j?null:j,h=e.setAnimeIsDone,S=void 0===h?null:h,m=e.setTargetHp,O=void 0===m?null:m,k=e.setAttackerSp,g=void 0===k?null:k,v=e.setLinesStatus,T=void 0===v?null:v,w=e.setPosition,C=void 0===w?null:w,z=e.setShowSkill,I=void 0===z?null:z;switch(n){case"\u9632\u79a6":C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:200,y:50,tension:100})}));var E=function(){return setTimeout((function(){return C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:250,y:50,mass:2,friction:5,tension:1e3,tint:13631488})})),l<=0?R({type:"dead"}):N({type:"def"})}),y.seconds)},F=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:250,y:0})})),N({type:"dodge"})}),y.seconds)},R=function(e){var t=e.type;return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:200,y:50,friction:2,tint:198430})})),T((function(e){return{status:t,character:"USER"===e.character?"ENEMY":"USER"}})),H()}),5e3)},H=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{alpha:0})})),M()}),3e3)},N=function(e){var t=e.type;return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:200,y:50,mass:1,friction:20,tension:170,tint:16777215})})),T((function(e){return{status:t,character:"USER"===e.character?"ENEMY":"USER"}})),M()}),5e3)},M=function(){return setTimeout((function(){S(!0)}),3e3)};return s?E():F();case"\u634c\u4e4b\u578b\u2015\u6edd\u58fa":b({type:"STANDBY",defence:!1,seconds:0}),C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:550,y:50,tension:100})}));var P=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:0,y:-100,tension:100})})),b((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"SKILL"})})),G()}),3e3)},G=function(){var e={number:u};xe.a.to(e,.8,{number:x,onUpdate:function(){g(ye()(e.number).format("0"))}}),T((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:"attack"})})),I((function(e){return D.resources["".concat(e.name,"-skill","3","-show")].data.play(),Object(r.a)(Object(r.a)({},e),{},{status:!0,type:"3",callback:function(){b((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"STOP",defence:!0})})),C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-400,y:50,tension:1e3})})),B()}})}))},B=function(){var e={number:c};return s&&xe.a.to(e,.8,{number:l<0?0:l,onUpdate:function(){O(ye()(e.number).format("0"))}}),setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:550,y:50,tension:50})}))}),3e3)};return C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:250,y:50,tension:100})})),P();default:b({type:"STANDBY",defence:!1,seconds:1200}),C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:550,y:50,tension:100})}));var L=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:0,y:50,tension:100})})),b((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"SKILL"})})),A()}),3e3)},A=function(){var e={number:u};return xe.a.to(e,.8,{number:x,onUpdate:function(){g(ye()(e.number).format("0"))}}),T((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:"attack"})})),setTimeout((function(){b((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"STOP",defence:!0})})),U()}),3e3)},U=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-250,y:50,tension:1e3})})),Y()}),1e3)},Y=function(){var e={number:c};return s&&xe.a.to(e,.8,{number:l<0?0:l,onUpdate:function(){O(ye()(e.number).format("0"))}}),setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:550,y:50,tension:50})}))}),3e3)};return C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:250,y:50,tension:100})})),L()}},be=function(e){var t=e.skillName,n=e.attackerName,s=e.position;switch(t){case"\u65ac\u64ca":return Object(a.jsx)(oe.Spring,{from:{x:550,y:50},to:{x:s.x,y:s.y},config:{mass:1,tension:s.tension,friction:20},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:3,width:200,height:200,anchor:.5,image:D.resources["".concat(n,"-fight-typeA")].data},e))}});case"\u9632\u79a6":return Object(a.jsx)(oe.Spring,{from:{x:650,y:50},to:{x:s.x,y:s.y},config:{mass:1,tension:s.tension,friction:20},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:2,width:200,height:200,anchor:.5,alpha:s.alpha,tint:s.tint,image:D.resources["".concat(n,"-fight-typeA")].data},e))}});default:return Object(a.jsx)(oe.Spring,{from:{x:550,y:50},to:{x:s.x,y:s.y},config:{mass:1,tension:s.tension,friction:20},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:3,width:200,height:200,anchor:.5,image:D.resources["".concat(n,"-fight-typeA")].data},e))}})}},he=function(e){return Object(a.jsx)(de,Object(r.a)(Object(r.a)({},e),{},{defXPostion:550,steps:je,ShowType:be}))},Se=function(e){var t=e.skillName,n=void 0===t?"":t,a=e.isHit,s=void 0!==a&&a,i=e.targetLife,c=void 0===i?0:i,o=e.attackerSp,u=void 0===o?0:o,f=e.resultLife,l=void 0===f?0:f,d=e.resultSp,x=void 0===d?0:d,p=e.BGstatus,y=void 0===p?{}:p,j=e.setBGstatus,b=void 0===j?null:j,h=e.setAnimeIsDone,S=void 0===h?null:h,m=e.setTargetHp,O=void 0===m?null:m,k=e.setAttackerSp,g=void 0===k?null:k,v=e.setLinesStatus,T=void 0===v?null:v,w=e.setPosition,C=void 0===w?null:w;e.setShowSkill;switch(n){case"\u9632\u79a6":C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:200,y:50,tension:100})}));var z=function(){return setTimeout((function(){return C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:250,y:50,mass:2,friction:5,tension:1e3,tint:13631488})})),l<=0?E({type:"dead"}):R({type:"def"})}),y.seconds)},I=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:250,y:0})})),R({type:"dodge"})}),y.seconds)},E=function(e){var t=e.type;return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:200,y:50,friction:2,tint:198430})})),T((function(e){return{status:t,character:"USER"===e.character?"ENEMY":"USER"}})),F()}),5e3)},F=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{alpha:0})})),H()}),3e3)},R=function(e){var t=e.type;return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:200,y:50,mass:1,friction:20,tension:170,tint:16777215})})),T((function(e){return{status:t,character:"USER"===e.character?"ENEMY":"USER"}})),H()}),5e3)},H=function(){return setTimeout((function(){S(!0)}),3e3)};return s?z():I();default:b({type:"STANDBY",defence:!1,seconds:1200}),C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:550,y:50,tension:100})}));var N=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:0,y:50,tension:100})})),b((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"SKILL"})})),M()}),3e3)},M=function(){var e={number:u};return xe.a.to(e,.8,{number:x,onUpdate:function(){g(ye()(e.number).format("0"))}}),T((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:"attack"})})),setTimeout((function(){b((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"STOP",defence:!0})})),P()}),3e3)},P=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-250,y:50,tension:1e3})})),G()}),1e3)},G=function(){var e={number:c};return s&&xe.a.to(e,.8,{number:l<0?0:l,onUpdate:function(){O(ye()(e.number).format("0"))}}),setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:550,y:50,tension:50})}))}),3e3)};return C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:250,y:50,tension:100})})),N()}},me=function(e){var t=e.skillName,n=e.attackerName,s=e.position;switch(t){case"\u9632\u79a6":return Object(a.jsx)(oe.Spring,{from:{x:650,y:50},to:{x:s.x,y:s.y},config:{mass:1,tension:s.tension,friction:20},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:2,width:200,height:200,anchor:.5,alpha:s.alpha,tint:s.tint,image:D.resources["".concat(n,"-fight")].data},e))}});default:return Object(a.jsx)(oe.Spring,{from:{x:550,y:50},to:{x:s.x,y:s.y},config:{mass:1,tension:s.tension,friction:20},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:3,width:200,height:200,anchor:.5,image:D.resources["".concat(n,"-fight")].data},e))}})}},Oe=function(e){return Object(a.jsx)(de,Object(r.a)(Object(r.a)({},e),{},{defXPostion:550,steps:Se,ShowType:me}))},ke=function(e){var t=e.attacker,n=void 0===t?{}:t,s=e.skill,i=void 0===s?{}:s,c=e.BGstatus,o=e.isHit,u=void 0!==o&&o,f=e.targetLife,l=void 0===f?0:f,d=e.attackerSp,x=void 0===d?0:d,p=e.resultLife,y=void 0===p?0:p,j=e.resultSp,b=void 0===j?0:j,h=e.setBGstatus,S=e.setAnimeIsDone,m=e.setTargetHp,O=e.setAttackerSp,k=e.setLinesStatus,g=e.setShowSkill,v={skillName:i.name,attackerName:n.name,isHit:u,targetLife:l,attackerSp:x,resultLife:y,resultSp:b,BGstatus:c,setBGstatus:h,setAnimeIsDone:S,setTargetHp:m,setAttackerSp:O,setLinesStatus:k,setShowSkill:g};switch(n.name){case"Tanjirou":return Object(a.jsx)(he,Object(r.a)({},v));case"Nezuko":return Object(a.jsx)(Oe,Object(r.a)({},v));default:return}},ge=function(e){var t=e.skillName,n=void 0===t?"":t,a=e.isHit,s=void 0!==a&&a,i=e.targetLife,c=void 0===i?0:i,o=e.attackerSp,u=void 0===o?0:o,f=e.resultLife,l=void 0===f?0:f,d=e.resultSp,x=void 0===d?0:d,p=e.BGstatus,y=void 0===p?{}:p,j=e.setBGstatus,b=void 0===j?null:j,h=e.setAnimeIsDone,S=void 0===h?null:h,m=e.setTargetHp,O=void 0===m?null:m,k=e.setAttackerSp,g=void 0===k?null:k,v=e.setLinesStatus,T=void 0===v?null:v,w=e.setPosition,C=void 0===w?null:w;e.setShowSkill;switch(n){case"\u9632\u79a6":C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-200,tension:150})}));var z=function(){return setTimeout((function(){return C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-235,y:20,mass:2,friction:5,tension:1e3,tint:13631488})})),l<=0?E({type:"dead"}):R({type:"def"})}),y.seconds)},I=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-235,y:-10})})),R({type:"dodge"})}),y.seconds)},E=function(e){var t=e.type;return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-200,y:10,friction:2,tint:198430})})),T((function(e){return{status:t,character:"USER"===e.character?"ENEMY":"USER"}})),F()}),5e3)},F=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{alpha:0})})),H()}),3e3)},R=function(e){var t=e.type;return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-200,y:10,mass:1,friction:20,tension:170,tint:16777215})})),T((function(e){return{status:t,character:"USER"===e.character?"ENEMY":"USER"}})),H()}),5e3)},H=function(){return setTimeout((function(){S(!0)}),3e3)};return s?z():I();default:b({type:"ENEMYSTANDBY",defence:!1,seconds:1200}),C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-600,tension:100})}));var N=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:0,tension:100})})),b((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"ENEMYSKILL"})})),M()}),3e3)},M=function(){var e={number:u};return xe.a.to(e,.8,{number:x,onUpdate:function(){g(ye()(e.number).format("0"))}}),T((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:"attack"})})),setTimeout((function(){b((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"STOP",defence:!0})})),P()}),3e3)},P=function(){return setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:175,tension:1e3})})),G()}),1e3)},G=function(){var e={number:c};return s&&xe.a.to(e,.8,{number:l<0?0:l,onUpdate:function(){O(ye()(e.number).format("0"))}}),setTimeout((function(){C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-600,tension:50})}))}),3e3)};return C((function(e){return Object(r.a)(Object(r.a)({},e),{},{x:-200,tension:100})})),N()}},ve=function(e){var t=e.skillName,n=e.attackerName,s=e.position;switch(t){case"\u9632\u79a6":return Object(a.jsx)(oe.Spring,{from:{x:-600,y:10},to:{x:s.x,y:s.y},config:{mass:s.mass,tension:s.tension,friction:s.friction},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:2,width:300,height:300,anchor:.5,alpha:s.alpha,tint:s.tint,image:D.resources["".concat(n,"-fight")].data},e))}});default:return Object(a.jsx)(oe.Spring,{from:{x:-600,y:50},to:{x:s.x,y:s.y},config:{mass:1,tension:s.tension,friction:20},children:function(e){return Object(a.jsx)(x.Sprite,Object(r.a)({zIndex:3,width:300,height:300,anchor:.5,image:D.resources["".concat(n,"-fight")].data},e))}})}},Te=function(e){return Object(a.jsx)(de,Object(r.a)(Object(r.a)({},e),{},{defXPostion:-600,steps:ge,ShowType:ve}))},we=function(e){var t=e.attacker,n=void 0===t?{}:t,s=e.skill,i=void 0===s?{}:s,c=e.BGstatus,o=e.isHit,u=void 0!==o&&o,f=e.targetLife,l=void 0===f?0:f,d=e.attackerSp,x=void 0===d?0:d,p=e.resultLife,y=void 0===p?0:p,j=e.resultSp,b=void 0===j?0:j,h=e.setBGstatus,S=e.setAnimeIsDone,m=e.setTargetHp,O=e.setAttackerSp,k=e.setLinesStatus,g=e.setShowSkill,v={skillName:i.name,attackerName:n.name,isHit:u,targetLife:l,attackerSp:x,resultLife:y,resultSp:b,BGstatus:c,setBGstatus:h,setAnimeIsDone:S,setTargetHp:m,setAttackerSp:O,setLinesStatus:k,setShowSkill:g};switch(n.name){case"Teoni":return Object(a.jsx)(Te,Object(r.a)({},v));default:return}},Ce=function(e){var t=e.props,n=t.stageStatus,i=t.animeShow,c=t.chess,o=t.enemyChess,f=t.setMoveStep,l=t.setAnimeShow,d=t.setUsualTip,p=t.setCurrentChess,y=t.dispatch,j=i.target,b=i.attacker,h=function(){var e=Object(s.useState)({type:"STANDBY",defence:!1,seconds:1200}),t=Object(u.a)(e,2),h=t[0],S=t[1],m=Object(s.useState)({toX:400,duration:2e4}),O=Object(u.a)(m,2),k=O[0],g=O[1],v=Object(s.useState)({toX:400,duration:500}),w=Object(u.a)(v,2),C=w[0],I=w[1],E=Object(s.useState)(j.prevLife),F=Object(u.a)(E,2),R=F[0],H=F[1],N=Object(s.useState)(b.prevSP),M=Object(u.a)(N,2),P=M[0],G=M[1],A=Object(s.useState)(!1),U=Object(u.a)(A,2),Y=U[0],q=U[1],K=Object(s.useState)({character:i.type,status:"default"}),V=Object(u.a)(K,2),X=V[0],W=V[1],J=Object(s.useState)({status:!1,type:"0",name:c[b.key].name,callback:null}),Q=Object(u.a)(J,2),Z=Q[0],$=Q[1],_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(e){case"CHESS":return"USER"===i.type?c["number"!==typeof i.attacker.key?0:i.attacker.key]:c["number"!==typeof i.target.key?0:i.target.key];case"ENEMYCHESS":return"USER"===i.type?o["number"!==typeof i.target.key?0:i.target.key]:o["number"!==typeof i.attacker.key?0:i.attacker.key]}},ee=function(){var e=L.r.from(D.resources["".concat(c[b.key].name,"-skill").concat(Z.type,"-show")].data),t=e.baseTexture.resource.source;return t.onended=function(){$((function(e){return t.currentTime=0,Object(r.a)(Object(r.a)({},e),{},{status:!1})})),Z.callback()},Object(a.jsx)(x.Sprite,{zIndex:99,width:600,height:370,anchor:.5,x:0,y:-35,image:D.resources["".concat(c[b.key].name,"-talk-attack")].data,texture:e})};return Object(s.useEffect)((function(){Y&&(l({status:!1,type:"",isHit:!1,attacker:{key:"",skill:{},prevSP:0},target:{key:"",isHit:!1,prevLife:0}}),"USER"===i.type&&o[j.key].hp<=0?(y(B({key:j.key})),d({title:"\u5df2\u64ca\u6557 ".concat(o[j.key].cn,"!"),status:!0})):"ENEMY"===i.type&&c[j.key].hp<=0?(y(T({key:j.key})),d({title:"".concat(c[j.key].cn," \u6230\u6557"),status:!0})):f(!0),"ENEMY"===i.type&&(y(z()),p((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"USERROUND"})})),d({title:"\u6211\u65b9\u56de\u5408",status:!0})))}),[Y]),Object(a.jsxs)(x.Container,{sortableChildren:!0,children:[Object(a.jsx)(re,{props:{stageStatus:n,BGstatus:h,BGprop:k,SkBGprop:C,setBGpops:g,setSkBGpops:I}}),Object(a.jsx)(ue,{right:_("CHESS"),left:_("ENEMYCHESS"),showType:i.type,targetHp:R,attackerSp:P}),Object(a.jsx)(ke,{attacker:_("CHESS"),skill:"USER"===i.type?i.attacker.skill:{name:"\u9632\u79a6"},BGstatus:h,isHit:i.isHit,targetLife:j.prevLife,attackerSp:b.prevSP,resultLife:j.prevLife-i.attacker.skill.atk,resultSp:b.prevSP-i.attacker.skill.sp,setBGstatus:S,setAnimeIsDone:q,setTargetHp:H,setAttackerSp:G,setLinesStatus:W,setShowSkill:$}),Object(a.jsx)(we,{attacker:_("ENEMYCHESS"),skill:"USER"===i.type?{name:"\u9632\u79a6"}:i.attacker.skill,BGstatus:h,isHit:i.isHit,targetLife:j.prevLife,attackerSp:b.prevSP,resultLife:j.prevLife-i.attacker.skill.atk,resultSp:b.prevSP-i.attacker.skill.sp,setBGstatus:S,setAnimeIsDone:q,setTargetHp:H,setAttackerSp:G,setLinesStatus:W,setShowSkill:$}),Z.status&&Object(a.jsx)(ee,{}),Object(a.jsx)(le,{right:_("CHESS"),left:_("ENEMYCHESS"),linesStatus:X}),Object(a.jsx)(x.Sprite,{zIndex:99,interactive:!0,buttonMode:!0,width:75,height:35,x:310,y:240,image:D.resources.fightOff.data,pointertap:function(){l({status:!1,type:"",isHit:!1,attacker:{key:"",skill:{},prevSP:0},target:{key:"",isHit:!1,prevLife:0}}),"USER"===i.type&&o[j.key].hp<=0?(y(B({key:j.key})),d({title:"\u5df2\u64ca\u6557 ".concat(o[j.key].cn,"!"),status:!0})):"ENEMY"===i.type&&c[j.key].hp<=0?(y(T({key:j.key})),d({title:"".concat(c[j.key].cn," \u6230\u6557"),status:!0})):f(!0),"ENEMY"===i.type&&(y(z()),p((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"USERROUND"})})),d({title:"\u6211\u65b9\u56de\u5408",status:!0}));!function(){for(var e=window.setTimeout(null,0);e--;)window.clearTimeout(e)}()}})]})};return Object(a.jsx)(x.Graphics,{x:400,y:300,zIndex:99,draw:function(e){e.beginFill("0x011627"),e.drawRoundedRect(-400,-300,800,600,0),e.endFill()},children:Object(a.jsx)(h,{})})},ze=function(e){var t=e.props,n=t.stageStatus,s=void 0===n?"":n,i=t.roundNum,c=void 0===i?Number:i,o=t.setMoveStep,u=t.setOtherTab,f=t.setTipStatus,l=t.setCurrentChess;return Object(a.jsxs)(x.Graphics,{x:400,y:300,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x22223b"),e.drawRoundedRect(-200,-150,400,300,8),e.endFill()},children:[Object(a.jsx)(x.Sprite,{interactive:!0,buttonMode:!0,width:25,height:25,anchor:.5,x:175,y:-125,image:D.resources.closeIcon.data,pointertap:function(){o(!0),u(!1),f((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:!1})}))}}),Object(a.jsx)(x.Sprite,{interactive:!0,buttonMode:!0,width:75,height:35,x:105,y:90,image:D.resources.endBtn.data,pointertap:function(){l({key:0,type:"ENDROUND"}),f((function(e){return Object(r.a)(Object(r.a)({},e),{},{title:"\u7d50\u675f\u56de\u5408?",status:!0})}))}}),Object(a.jsx)(x.Text,{text:"\u4f5c\u6230\u76ee\u7684",x:-170,y:-125,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:["#ffffff","#00ff99"]})}),Object(a.jsx)(x.Text,{text:ae.getIn([s,"ruleText","win"]),x:-150,y:-90,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:["#ffffff","#ffffff"]})}),Object(a.jsx)(x.Text,{text:"\u6230\u6557\u689d\u4ef6",x:-170,y:-40,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:["#ffffff","#ee6c4d"]})}),Object(a.jsx)(x.Text,{text:ae.getIn([s,"ruleText","lose"]),x:-150,y:-5,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:["#ffffff","#ffffff"]})}),Object(a.jsx)(x.Text,{text:"\u56de\u5408\u6578",x:-170,y:45,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:["#ffffff","#8d99ae"]})}),Object(a.jsx)(x.Text,{text:"\u7b2c ".concat(c," \u56de"),x:-150,y:80,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:["#ffffff","#ffffff"]})})]})},Ie=function(e){var t=e.oder,n=void 0===t?0:t,s=e.enemyRandomSkill,i=void 0===s?0:s,c=e.enemyList,o=void 0===c?[]:c,r=o[n].skill;return Object(a.jsxs)(x.Container,{sortableChildren:!0,children:[Object(a.jsx)(x.Sprite,{width:65,height:65,anchor:.5,x:175,y:-75,image:D.resources["".concat(o[n].name,"-head-default")].data}),Object(a.jsx)(x.Text,{text:"".concat(o[n].cn," / \u6280\u80fd"),anchor:{x:.5},x:175,y:-30,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{text:"".concat(r[i].name),anchor:{x:.5},x:175,y:10,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:["#f15bb5","#e0aaff"]})}),Object(a.jsx)(x.Text,{text:"ATK / ".concat(r[i].atk),anchor:{x:.5},x:175,y:40,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:["#f15bb5","#e0aaff"]})})]})},Ee=function(e){var t=e.chessList,n=e.defChess,s=e.setDefChess;return Object(a.jsxs)(x.Container,{sortableChildren:!0,children:[Object(a.jsx)(x.Graphics,{x:-250,y:-180,zIndex:1,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x0f0f1b"),e.drawRoundedRect(0,0,100,360,8),e.endFill()}}),t.map((function(e,t){var c=85*t;return Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(x.Sprite,{interactive:!0,buttonMode:!0,width:65,height:65,anchor:.5,zIndex:2,x:-200,y:-125+c,image:D.resources["".concat(e.name,"-head-default")].data,pointertap:function(){return s(t)}}),t===n&&Object(a.jsx)(x.Graphics,{anchor:.5,x:-200,y:-125+c,zIndex:1,draw:function(e){e.beginFill("0x7b2cbf"),e.drawRoundedRect(-38,-38,76,76,5),e.endFill()}})]},t)}))]})},Fe=function(e){var t=e.defChess,n=e.chessList,s=e.atkEnemy,i=n[t].dodge-s.hitfix>=0?n[t].dodge-s.hitfix:0;return Object(a.jsx)(x.Container,{sortableChildren:!0,children:Object(a.jsxs)(x.Graphics,{x:-125,y:-150,children:[Object(a.jsx)(x.Text,{text:"\u9078\u64c7\u9632\u79a6\uff1a".concat(n[t].cn),anchor:{x:0},style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{text:"HP\uff1a".concat(n[t].hp),anchor:{x:0},y:30,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#ff6b6b"})}),Object(a.jsx)(x.Text,{text:"\u8ff4\u907f\u7387\uff1a".concat(i,"%"),anchor:{x:0},y:60,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:["#ffffff","#4cc9f0"]})})]})})},Re=function(e){var t=e.props,n=Object(s.useState)(0),i=Object(u.a)(n,2),c=i[0],o=i[1],f=t.enemyRoundTab,l=t.chess,d=t.enemyChess,p=t.setEnemyRoundTab,y=t.setAnimeShow,j=t.setCurrentChess,b=t.setCurrentBGM,h=t.dispatch,S=l.filter((function(e){return e.debut})),m=d.filter((function(e){return e.debut})),O=m[f.oder].skill,k=m[f.oder].sp,g=function(){var e=O.length-1,t=Math.round(Math.random()*e);return 0===k||O[t].sp>k?0:t}(),v=function(e){var t,n=e.chess,a=e.debut,s=e.key;return n.find((function(e,n){return e.id===a[s].id?t=n:null})),t};return Object(a.jsxs)(x.Graphics,{x:400,y:300,zIndex:99,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x22223b"),e.drawRoundedRect(-300,-200,600,400,8),e.endFill()},children:[Object(a.jsx)(Ee,{chessList:S,defChess:c,setDefChess:o}),Object(a.jsx)(Fe,{defChess:c,chessList:S,atkEnemy:m[f.oder].skill[g]}),Object(a.jsx)(Ie,{oder:f.oder,enemyRandomSkill:g,enemyList:m}),Object(a.jsx)(x.Sprite,{interactive:!0,buttonMode:!0,width:90,height:42,anchor:.5,zIndex:2,x:230,y:155,image:D.resources.fightDef.data,pointertap:function(){b(m[f.oder].name);var e=ie(m[f.oder].skill[g].hitfix,S[c].dodge);j((function(e){return Object(r.a)(Object(r.a)({},e),{},{type:"ATTACK"})})),h(G({key:v({chess:d,debut:m,key:f.oder}),lessSp:m[f.oder].skill[g].sp})),e&&h(C({key:v({chess:l,debut:S,key:c}),damage:m[f.oder].skill[g].atk})),p((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:!1})})),y({status:!0,type:"ENEMY",isHit:e,attacker:{key:v({chess:d,debut:m,key:f.oder}),skill:m[f.oder].skill[g],prevSP:m[f.oder].sp},target:{key:v({chess:l,debut:S,key:c}),isHit:e,prevLife:S[c].hp}})}})]})},He=function(e){var t=e.ChessData,n=e.ChessVal,i=e.ChessKey,c=e.EnemyChessData,o=e.positionX,r=e.positionY,f=e.setCurrentChess,l=e.setMoveStep,d=e.dispatch,p=720,y=490,j=[],b=[],h=Object(s.useState)(Object(ne.a)([{id:1,title:"\u79fb\u52d5",textColor:["#ffffff","#ffffff"]},{id:2,title:"\u653b\u64ca",textColor:["#ffffff","#ffffff"]},{id:3,title:"\u72c0\u614b",textColor:["#ffffff","#ffffff"]},{id:4,title:"\u8fd4\u56de",textColor:["#ffffff","#ffffff"]}])),S=Object(u.a)(h,2),m=S[0],O=S[1];t.map((function(e){return j.push({x:e.x,y:e.y}),b.push({x:e.x,y:e.y})})),c.map((function(e){return j.push({x:e.x,y:e.y})}));var v=function(e,n,a){var s=!1;return t.filter((function(e){return e.debut})).map((function(t){if(t.x!==e||t.y!==n)return null;switch(a){case"MOVE":case"ATTACK":var i=t.roundMove>0;return s=i;default:return!0}})),s},T=function(e){e.noop;var t=function(e,t,n){for(var a=!1,s=c.filter((function(e){return e.debut})),i=19,o=14,r=[],u=0;u<n;u++){var f=e+(u+1)>=i?i:e+(u+1),l=t+(u+1)>=o?o:t+(u+1),d=e-(u+1)<=0?0:e-(u+1),x=t-(u+1)<=0?0:t-(u+1);r.push({x:f,y:t},{x:d,y:t},{x:e,y:l},{x:e,y:x})}return s.map((function(e){return r.map((function(t){return e.x===t.x&&e.y===t.y?a=!0:null}))})),a}(n.x,n.y,n.attack);return m.map((function(e,s){var c=function(){switch(e.get("id")){case 1:return v(n.x,n.y,"MOVE");case 2:return t&&v(n.x,n.y,"ATTACK");default:return!0}};return Object(a.jsx)(x.Text,{interactive:c(),buttonMode:!0,text:e.get("title"),x:10,y:5+25*s,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:c()?e.get("textColor").toJS():"#8d99ae"}),pointerover:function(){O((function(e){return e.setIn([s,"textColor",1],"#00ff99")}))},pointerout:function(){O((function(e){return e.setIn([s,"textColor",1],"#ffffff")}))},pointertap:function(t){switch(e.get("id")){case 1:f({key:i,type:"MOVE"}),d(Z({position:{x:n.x,y:n.y},step:n.step,changeColor:"0x06d6a0",currentChessPositions:j})),d(k({key:i}));break;case 2:f({key:i,type:"ATTACK"}),d(k({key:i})),d($({position:{x:n.x,y:n.y},step:n.attack,changeColor:"0x00bbf9",currentChessPositions:b}));break;case 3:f({key:i,type:"STATUS"}),d(g({key:i})),d(k({key:i}));break;case 4:l(!0),d(k({key:i}));break;default:return console.log(t.target)}}},s)}))};return Object(a.jsx)(x.Graphics,{x:800!==o?o:p,y:560!==r&&520!==r?r:y,zIndex:3,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x22223b"),e.drawRoundedRect(0,0,60,110,8),e.endFill()},children:Object(a.jsx)(T,{})})},Ne=function(e){var t=e.ChessData,n=e.ChessKey,s=e.CheckStatus,c=e.setMoveStep,o=e.dispatch,r=function(){return t.skill.map((function(e,t){return Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(x.Text,{x:-40,y:22*t-70,text:"".concat(e.name),style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ffb700"})}),Object(a.jsx)(x.Text,{x:16*e.name.length-35,y:22*t-70,text:"ATK:".concat(e.atk,"(").concat(e.sp,"SP)"),style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:14,fill:"#ffffff"})})]},t)}))};return Object(a.jsxs)(x.Graphics,{x:400,y:300,zIndex:99,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x22223b"),e.drawRoundedRect(-250,-150,500,300,8),e.endFill()},children:[Object(a.jsx)(x.Sprite,{interactive:!0,buttonMode:!0,width:25,height:25,anchor:.5,x:220,y:-120,image:D.resources.closeIcon.data,pointertap:function(){c(!0),o(s({key:n}))}}),Object(a.jsx)(x.Sprite,{width:80,height:80,x:-200,y:-90,image:D.resources["".concat(t.name,"-head-default")].data}),Object(a.jsx)(x.Text,{x:-200,y:10,text:t.cn,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{x:-200,y:35,text:"HP:",style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{x:-170,y:35,text:"".concat(t.hp," / ").concat(t.fullValue.hp),style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ff6b6b"})}),Object(a.jsx)(x.Text,{x:-200,y:60,text:"SP:",style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ffffff"})}),Object(a.jsx)(x.Text,{x:-170,y:60,text:"".concat(t.sp," / ").concat(t.fullValue.sp),style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#0466c8"})}),Object(a.jsx)(x.Text,{x:-50,y:-95,text:"\u62db\u5f0f",style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:16,fill:"#ffffff"})}),Object(a.jsx)(r,{})]})},Me=function(e){var t=e.chessProps,n=t.chess,s=t.enemyChess,c=t.moveStep,o=void 0===c?Boolean:c,r=t.setMoveStep,u=t.setCurrentChess,f=t.dispatch;return n.map((function(e,t){var c=0===e.roundMove;return Object(a.jsxs)(i.a.Fragment,{children:[e.debut&&Object(a.jsx)(x.Sprite,{interactive:o,buttonMode:!0,width:40,height:40,x:40*e.x,y:40*e.y,zIndex:2,tint:c?4804695:16777215,pointerover:function(){f(Q({position:{x:e.x,y:e.y},step:e.step,changeColor:"0x06d6a0",alphaVal:.5}))},pointerout:function(){f(Q({position:{x:e.x,y:e.y},step:e.step,changeColor:"0x383838",alphaVal:0}))},pointertap:function(){r(!1),f(k({key:t})),f(Q({position:{x:e.x,y:e.y},step:e.step,changeColor:"0x383838",alphaVal:0}))},image:D.resources["".concat(e.name,"-head-default")].data}),e.boardStatus&&Object(a.jsx)(He,{ChessData:n,ChessVal:e,ChessKey:t,EnemyChessData:s,positionX:40*e.x+40,positionY:40*e.y,setCurrentChess:u,setMoveStep:r,dispatch:f}),e.checkStatus&&Object(a.jsx)(Ne,{ChessData:e,ChessKey:t,CheckStatus:g,setMoveStep:r,dispatch:f})]},t)}))},Pe=function(e){var t=e.ChessKey,n=e.positionX,i=e.positionY,c=e.setMoveStep,o=e.dispatch,r=720,f=535,l=Object(s.useState)(Object(ne.a)([{id:1,title:"\u72c0\u614b",textColor:["#ffffff","#ffffff"]},{id:2,title:"\u8fd4\u56de",textColor:["#ffffff","#ffffff"]}])),d=Object(u.a)(l,2),p=d[0],y=d[1],j=function(e){e.noop;return p.map((function(e,n){return Object(a.jsx)(x.Text,{interactive:!0,buttonMode:!0,text:e.get("title"),x:10,y:5+25*n,style:new L.q({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:20,fill:e.get("textColor").toJS()}),pointerover:function(){y((function(e){return e.setIn([n,"textColor",1],"#9d4edd")}))},pointerout:function(){y((function(e){return e.setIn([n,"textColor",1],"#ffffff")}))},pointertap:function(n){switch(e.get("id")){case 1:o(M({key:t})),o(N({key:t}));break;case 2:c(!0),o(N({key:t}));break;default:return console.log(n.target)}}},n)}))};return Object(a.jsx)(x.Graphics,{x:800!==n?n:r,y:560!==i&&520!==i?i:f,zIndex:3,draw:function(e){e.lineStyle(1,"0xffffff",1),e.beginFill("0x22223b"),e.drawRoundedRect(0,0,60,62,8),e.endFill()},children:Object(a.jsx)(j,{})})},Ge=function(e){var t=e.enemyChessProps,n=t.enemyChess,s=t.moveStep,c=void 0===s?Boolean:s,o=t.setMoveStep,r=t.dispatch;return n.map((function(e,t){return Object(a.jsxs)(i.a.Fragment,{children:[e.debut&&Object(a.jsx)(x.Sprite,{interactive:c,buttonMode:!0,width:40,height:40,x:40*e.x,y:40*e.y,zIndex:2,pointertap:function(){o(!1),r(N({key:t}))},image:D.resources["".concat(e.name,"-head-default")].data}),e.boardStatus&&Object(a.jsx)(Pe,{ChessKey:t,positionX:40*e.x+40,positionY:40*e.y,setMoveStep:o,dispatch:r}),e.checkStatus&&Object(a.jsx)(Ne,{ChessData:e,ChessKey:t,CheckStatus:M,setMoveStep:o,dispatch:r})]},t)}))},Be=function(){var e=Object(s.useState)(!1),t=Object(u.a)(e,2),n=t[0],i=t[1],c=Object(s.useState)("stageOne"),o=Object(u.a)(c,2),r=o[0],f=(o[1],Object(s.useState)(1)),l=Object(u.a)(f,2),y=l[0],j=l[1],b=Object(s.useState)(!1),h=Object(u.a)(b,2),S=h[0],O=h[1],k=Object(s.useState)({oder:0,status:!1}),g=Object(u.a)(k,2),v=g[0],T=g[1],w=Object(s.useState)({key:0,type:"MOVE"}),C=Object(u.a)(w,2),z=C[0],I=C[1],E=Object(s.useState)({title:"",status:!1}),F=Object(u.a)(E,2),R=F[0],N=F[1],M=Object(s.useState)({title:"",status:!1,position:{x:0,y:0}}),P=Object(u.a)(M,2),G=P[0],B=P[1],L=Object(s.useState)({status:!1,attacker:{key:""},target:{key:""}}),A=Object(u.a)(L,2),q=A[0],K=A[1],V=Object(s.useState)({status:!1,type:"",attacker:{key:"",skill:{},prevSP:0},target:{key:"",isHit:!1,prevLife:0}}),X=Object(u.a)(V,2),W=X[0],J=X[1],Q=Object(s.useState)(!0),Z=Object(u.a)(Q,2),$=Z[0],_=Z[1],ne=Object(s.useState)(""),ie=Object(u.a)(ne,2),oe=ie[0],re=ie[1],ue=Object(s.useState)(""),fe=Object(u.a)(ue,2),le=fe[0],de=fe[1],xe=Object(d.c)((function(e){return e.chessMap})),pe=Object(d.c)((function(e){return e.chess})),ye=Object(d.c)((function(e){return e.enemyChess})),je=Object(d.b)();return Object(s.useEffect)((function(){switch(oe){case"Tanjirou":U.round.fade(1,0,1e3),U.KimetsuNoYaiba.stop(),U.KimetsuNoYaiba.volume(1),U.KimetsuNoYaiba.play();break;case"Teoni":U.round.fade(1,0,1e3),U.KimetsuNoYaibaEnemy.stop(),U.KimetsuNoYaibaEnemy.volume(1),U.KimetsuNoYaibaEnemy.play();break;case"enemyRounds":case"userRounds":U.round.stop(),U.round.volume(1),U.round.play();break;default:p.Howler.stop()}}),[oe]),Object(s.useEffect)((function(){switch(le){case"Tanjirou":U.KimetsuNoYaiba.fade(1,0,1e3),re("enemyRounds");break;case"Teoni":U.KimetsuNoYaibaEnemy.fade(1,0,1e3),re("userRounds");break;default:p.Howler.stop()}}),[le,r]),Object(s.useEffect)((function(){n&&(je(m({isDebutChess:ae.getIn([r,"debutChess"])})),je(H({isDebutChess:ae.getIn([r,"debutEnemyChess"])})))}),[je,n,r]),Object(a.jsxs)(x.Stage,{width:800,height:600,options:{autoDensity:!0,antialias:!0,backgroundColor:75306},children:[Object(a.jsxs)(x.Container,{sortableChildren:!0,children:[n&&Object(a.jsx)(x.Sprite,{width:30,height:30,anchor:.5,x:760,y:40,zIndex:99,interactive:$,buttonMode:!0,image:D.resources.otherIcon.data,pointertap:function(){O(!0),_(!1)}}),Object(a.jsx)(x.Sprite,{width:800,height:600,zIndex:1,image:D.resources["".concat(r,"-main-BG")].data}),Object(a.jsx)(ee,{reduxProps:{chess:pe,enemyChess:ye,chessMap:xe,currentChess:z,dispatch:je,setTipStatus:B,setMoveStep:_,setBattleInfo:K}}),Object(a.jsx)(Me,{chessProps:{chess:pe,enemyChess:ye,moveStep:$,setMoveStep:_,setCurrentChess:I,dispatch:je}}),Object(a.jsx)(Ge,{enemyChessProps:{enemyChess:ye,moveStep:$,setMoveStep:_,dispatch:je}})]}),S&&Object(a.jsx)(ze,{props:{stageStatus:r,roundNum:y,setMoveStep:_,setOtherTab:O,setTipStatus:B,setCurrentChess:I}}),G.status&&Object(a.jsx)(te,{props:{chess:pe,currentChess:z,tipStatus:G,currentBGM:oe,dispatch:je,setMoveStep:_,setTipStatus:B,setOtherTab:O,setRoundNum:j,setUsualTip:N,setFadeBGM:de}}),R.status&&Object(a.jsx)(se,{props:{stageStatus:r,chess:pe,currentChess:z,enemyChess:ye,usualTip:R,currentBGM:oe,setMoveStep:_,setUsualTip:N,setCurrentChess:I,setFadeBGM:de,setEnemyRoundTab:T}}),q.status&&Object(a.jsx)(ce,{props:{battleInfo:q,setMoveStep:_,setBattleInfo:K,setAnimeShow:J,setCurrentBGM:re,dispatch:je}}),W.status&&Object(a.jsx)(Ce,{props:{stageStatus:r,animeShow:W,chess:pe,enemyChess:ye,setMoveStep:_,setAnimeShow:J,setUsualTip:N,setCurrentChess:I,dispatch:je}}),v.status&&Object(a.jsx)(Re,{props:{enemyRoundTab:v,chess:pe,enemyChess:ye,setEnemyRoundTab:T,setAnimeShow:J,setCurrentChess:I,setCurrentBGM:re,dispatch:je}}),!n&&Object(a.jsx)(Y,{props:{setRoundStart:i}})]})};function Le(){var e=Object(f.a)(["\n  position: relative;\n  display:flex;\n  align-items:center;\n  justify-content:center;\n  width:100%;\n  height:100vh;\n  .loading {\n    color: #fff;\n    font-size:24px;\n  }\n"]);return Le=function(){return e},e}function Ae(){var e=Object(f.a)(["\n  body { background:#1d2430; }\n"]);return Ae=function(){return e},e}var De=Object(l.a)(Ae()),Ue=l.b.div(Le()),Ye=function(){var e=Object(s.useState)(!1),t=Object(u.a)(e,2),n=t[0],i=t[1],c=Object(s.useState)(!1),o=Object(u.a)(c,2),f=o[0],l=o[1],d=Object(s.useState)(0),x=Object(u.a)(d,2),p=x[0],y=x[1],j=Object(s.useState)({open:!1,KimetsuNoYaiba:!1}),b=Object(u.a)(j,2),h=b[0],S=b[1];return U.KimetsuNoYaiba.on("load",(function(){S((function(e){return Object(r.a)(Object(r.a)({},e),{},{KimetsuNoYaiba:!0})}))})),U.open.on("load",(function(){S((function(e){return Object(r.a)(Object(r.a)({},e),{},{open:!0})}))})),Object(s.useEffect)((function(){D.onProgress.add((function(e){y(Math.floor(e.progress))})),D.onComplete.add((function(e,t){y(100),i(!0)}))})),Object(s.useEffect)((function(){h.KimetsuNoYaiba&&h.open&&n&&l(!0)}),[n,h]),Object(a.jsxs)(Ue,{children:[Object(a.jsx)(De,{}),f?Object(a.jsx)(Be,{}):Object(a.jsx)("span",{className:"loading",children:n?"\u8b80\u53d6\u97f3\u8a0a\u4e2d...":"Loading ".concat(p,"%..")})]})},qe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,78)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),i(e),c(e)}))},Ke=n(7),Ve=Object(Ke.c)({chess:h,chessMap:W,enemyChess:F}),Xe=Object(Ke.e)(Ve);o.a.render(Object(a.jsx)(d.a,{store:Xe,children:Object(a.jsx)(Ye,{})}),document.getElementById("root")),qe()}},[[77,1,2]]]);
//# sourceMappingURL=main.f56b6837.chunk.js.map